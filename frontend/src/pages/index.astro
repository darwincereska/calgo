---
import Layout from "../layouts/Layout.astro";
import BottomBar from "../components/BottomBar.astro";
import { TITLE } from '../constants.ts'
---

<Layout title={TITLE}>
	<main class="flex">
	<div class="m-8 h-[calc(100vh-6rem)] w-[calc(100vw-2.5rem)] relative" id="editor">
		<div id="highlights" class="absolute top-0 left-0 w-full h-full pointer-events-none whitespace-pre-wrap"></div>
		<textarea id="input" class="absolute top-0 left-0 w-full h-full bg-transparent text-black resize-none outline-none" spellcheck="false"></textarea>
	</div>
	<BottomBar />
	</main>
</Layout>

<script>
const syntaxHighlighting = {
	keywords: {
		control: {
			words: ['if', 'else', 'for', 'while'],
			color: 'text-purple-500'
		},
		declaration: {
			words: ['function', 'let', 'const', 'var'],
			color: 'text-blue-500'  
		},
		operators: {
			words: ['return', 'new', 'delete', 'typeof'],
			color: 'text-red-500',
		}
	}
};

const input = document.getElementById('input');
const highlights = document.getElementById('highlights');

input.addEventListener('input', () => {
	let html = input.value;

	Object.values(syntaxHighlighting.keywords).forEach(category => {
		category.words.forEach(word => {
			const regex = new RegExp(`\\b${word}\\b`, 'g');
			html = html.replace(regex, `<span class="${category.color} font-bold">${word}</span>`);
		});
	});

	highlights.innerHTML = html;
});
</script>

<style>
#input {
	@apply p-4 font-mono text-base;
	border: none;
	color: transparent;
	caret-color: black;
}

#highlights {
	@apply p-4 font-mono text-base;
}
</style>
